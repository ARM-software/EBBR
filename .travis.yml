sudo: false
dist: trusty
cache:
  apt: true
env:
  global:
  - SPHINXBUILD=~/.local/bin/sphinx-build
  - secure: Nn985mEk01BbYLY7IQToa51+jpVp8/f72Q+SY6GVe1cf41gRG4CWrrLFLo4Zrdd+e5a9tMKJ2o6WqT4m0i1AziVnoFx62QtC0dmJVsp4eVzQdhWkaRTcLdoKp18om0To6cVmBzYFzsIUROyOwwJfprpzwylQGFqNFoNG20UmnzTy5c/bg36Ohh/vcpt3HXO6emKDTychu1fBC8tuiy7k5BCfPekKAg6sKTqjsgKM+pEZuv9zTzrBY0HVqCoSLhWUraADko51baOtbBOzLtH4L4EO1rmiFs7/HpN/MzF6REurCAbBM5q82aS/z5KUoMGENt+OwWbeT9BcqUty1wYAFwuK7UwkDO2+YauqGhZ75GKOt213Fdn70Wx1xMkOerdEb8oSdH8Av/FWxwbfI6qxsAhjimYTZ5OCCZu06AVMBugxBnZeYxF89+83qVUxCHNGyGnql1PHJnlIiOzmCmcgjFo90u9fv24497m9O9QlEic/PnN0VLogPOftgcRUdoLjsYh9P6+BvXrWQ0omu41UwnzNJERaeUXuXV+iJsj6kBuj1j6EJ7OK4RyS/Td8mC7sGFBdwOX+HLaPqBTD2rm7z0wtST0jyFJjPfmvCU94+ovpCuYeMxgeudnUXT8T26v6v73nk7QLIIYm1Idg2ibSBfQy5IT220sH6291IryoY2c=
git:
  depth: false
addons:
  apt:
    packages:
    - python-pip
    - latexmk
    - libalgorithm-diff-perl
    - texlive
    - texlive-latex-extra
    - texlive-humanities
    - texlive-generic-recommended
    - graphviz
    - texlive-generic-extra
install:
- pip install --user mako
- pip install --user Sphinx
script:
- make latexpdf
- make html
- make singlehtml
before_deploy:
- cp build/latex/ebbr.pdf build/ebbr-$TRAVIS_TAG.pdf
deploy:
- provider: releases
  prerelease: true
  api_key:
    secure: KckKibwGz7k8pXGmepSnMldUbRVN+0wizC2+uJc4JMKpsMVB2j21FC1niMtOPmLHRb3vdyGi58qRz27mVIvwAuRsyxlCnSwf+lvIb4ek21UTMNeaMTS2ROYjiYSpCMGcnFagpBCZQeNCCwa2rJoN6F3JikCiwxDXdysc4SnoCBFqZtQafTPyhU8U49DgEjqvJbmpzs1H854ni9VNXdJYDUyZ2MTtxWEsjc00AcEJj3X1AePMVqBGt6+IBv8Oxj5qn8Ni6Y/m4UhgoCxUx/QStYNF8QU0vmH7A1KlqF+0LOwPwlhVWlZ3EXMsuwmlaYnAW/pbrokcHpZxFNeGVIGtAI05/r95ecF8YjAd250W2kEYoa2TO/B44UeQjBjXtRSD8ei208ciyg04/dvG4HcU5wHWhEhbIBmnpBrhXAKpsBYfUaWx8XIeTcls/eOqO6JJ28c1xucjaYOJ1thhnlk3WHij5hzNcXTfcg0Rb8pTiR1JQduzz7udEvrfpUkbDT8zhpPYJKEAYHCBN5M8At1898rIU0c+jeHgO+cJgIofFQeQNXDv7fzHEgvpczbgssUm6SjvI4da/QKxuKhSuGj4aJWtMA5exOnYhQt+fuzpOa9kmh0IMVh7pFK1hJgmnKcAYwYNG64aa15OLpU5x6sf31FklU0VFlRqdUbow6tnZAo=
  file_glob: true
  file:
  - build/ebbr-*.pdf
  skip_cleanup: true
  on:
    repo: glikely/ebbr
- provider: pages
  github_token: "$GITHUB_TOKEN"
  local_dir: build/singlehtml
  skip_cleanup: true
  on:
    branch: master
